{% extends 'base.html' %}

{% block title %}{{ product.name }}{% endblock %}

{% block content %}

<a href="{% url 'product_list' %}" class="btn btn-secondary mb-3">← Назад к товарам</a>

<div class="row">
    <!-- Левая колонка — галерея -->
    <div class="col-md-6 text-center">

        {% if product.image %}
            <img id="mainImage" src="{{ product.image.url }}" class="product-main-img mb-3">
        {% endif %}

        <div class="d-flex flex-wrap justify-content-center gap-2">
            {% for img in product.images.all %}
                <img src="{{ img.image.url }}" class="thumb-img" onclick="changeImage(this)">
            {% endfor %}
        </div>

    </div>

    <!-- Правая колонка — описание -->
    <div class="col-md-6">
        <h2>{{ product.name }}</h2>
        {% if not product.hide_price %}
            <p class="price">{{ product.price }} ₽</p>
        {% else %}
            <p class="text-muted">Цена по запросу</p>
        {% endif %}
        <div class="mt-3 product-description">
            {{ product.description|safe }}
        </div>
    </div>
</div>

<!-- Lightbox -->
<div id="lightbox" onclick="closeLightbox()">
    <img id="lightboxImg">
</div>

<p class="mt-2">
    <strong>Категории:</strong>
    {% for cat in product.categories.all %}
        <span class="badge bg-secondary">{{ cat.name }}</span>
    {% empty %}
        <span class="text-muted">Нет категории</span>
    {% endfor %}
</p>

<script>
function changeImage(element) {
    document.getElementById("mainImage").src = element.src;
}

document.addEventListener("DOMContentLoaded", function() {
    const mainImage = document.getElementById("mainImage");
    if (mainImage) {
        mainImage.addEventListener("click", function() {
            openLightbox(this.src);
        });
    }
});

function openLightbox(src) {
    document.getElementById("lightbox").style.display = "block";
    document.getElementById("lightboxImg").src = src;
}

function closeLightbox() {
    document.getElementById("lightbox").style.display = "none";
}
</script>

{% endblock %}